{#
    image_src
    image_alt       // image.name(page is defined ? page.locale : '')
    image_attr
    image_wrapper           default: p
    image_wrapper_class     default: 'w-full h-auto'

        xs: #576px
        sm: #768px
        md: #992px
        lg: #1200px
        xl: #1200px+
#}

{% block inline_image %}
    {% if image_src is defined %}
        {% if image_wrapper_class is defined or image_wrapper is defined %}
            <{{ image_wrapper|default('p') }} {% if image_wrapper_class is defined %}class="{{ image_wrapper_class }}"{% endif %}>
            {% endif %}

                {% if is_internal_image(image_src) %}
                    {% set image =  img_to_media(image_src) %}

                    {{ image_link is not defined or image_link != false ?

                    link(
                        _self.renderImage(image, image_class ?? null, image_attr ?? null, image_alt ?? null),
                        image_link|default(image|image('default')),
                        image_link is not defined ? {'data-fslightbox': 'inline', 'dwl': image|image('default', 'webp')} : {}
                    )
                        : _self.renderImage(image, image_class ?? null, image_attr ?? null, image_alt ?? null)
                    }}

                {% else %}
                    <img
                        src="{{ image_src }}"
                        loading="lazy"
                        class="{{ (rounded is defined ? 'rounded' : '') ~ (image_class is defined and image_class ? ' '~image_class : ' ' ~ 'w-full h-auto') }}"
                        alt="{{ image_alt }}" />
                {% endif %}

            {% if image_wrapper_class is defined %}

            </{{ image_wrapper|default('p') }}>
        {% endif %}
    {% endif %}
{% endblock %}


{% macro renderImage(image, image_class = null, image_attr = null, image_alt = null) %}
<picture>
    <source type="image/webp"
        srcset="{{ image|image('xs', 'webp') ~' 576w'
            ~','~ image|image('sm', 'webp') ~' 768w'
            ~','~ image|image('md', 'webp') ~' 992w'
            ~','~ image|image('lg', 'webp') ~' 1200w'
            ~','~ image|image('xl', 'webp') ~' 1600w' }}" />
    <img {{ mergeAttr({srcset: image|image('xs') ~' 576w'
            ~','~ image|image('sm') ~' 768w'
            ~','~ image|image('md') ~' 992w'
            ~','~ image|image('lg') ~' 1200w'
            ~','~ image|image('xl') ~' 1600w',
        src: image|image('default'),
        loading: 'lazy',
        class: image_class is defined and image_class ? image_class : 'w-full h-auto',
        width: 100000,
        height: 100000,
        alt: image_alt|default(image.alt)
    }, image_attr ?? {}) }} />
</picture>
{% endmacro %}
